- name: Install Argo CD on Kubernetes
  hosts: master
  become: yes
  tasks:
    - name: Create a namespace for Argo CD
      kubectl:
        name: argocd
        state: present
        api_version: v1
        kind: Namespace

    - name: Install Argo CD using kubectl
      shell: kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml

    - name: Configure Git Repo
      shell: kubectl apply -n argocd -f secret.yml

    - name: Deploy argocd apps
      shell: kubectl apply -n argocd -f application.yaml

    - name: Wait for 120 seconds using sleep
      command: sleep 120

